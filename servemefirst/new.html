<!DOCTYPE html>
<html>
<title>ServeMeFirst Alpha 4.1.2</title>
<head>
<!Blake Peterson 2018
blake.r.peterson@gmail.com>
</head>
<body>
    <div id="mainButtons">
        <p>
            <div id="b0">
                <button id="newTable" type="button" onclick="newTable([player.tableCount])">Start</button> 
            </div>
        </p>
    </div>

    <div id = "gameBoard">
        <div id="table0">
            <table>
                <tbody id="dispBody0"></tbody>
            </table>
        </div>
        <p></p>
        <div id="table1">
            <table>
                <tbody id="dispBody1"></tbody>
            </table>
        </div>
        <p></p>
        <div id="table2">
            <table>
                <tbody id="dispBody2"></tbody>
            </table>
        </div>
        <p></p>
        <div id="table3">
            <table>
                <tbody id="dispBody3"></tbody>
            </table>
        </div>
    </div>

    
    <div id = "dev">
        <div id = "cheat">
            <button id="cheat1" type="button" onclick="cheat(1)">cheat01</button>
            <button id="cheat10" type="button" onclick="cheat(10)">cheat10</button>
            <button id="cheat20" type="button" onclick="cheat(20)">cheat20</button>
            <br>
            <button id="cheat25" type="button" onclick="cheat(25)">cheat25</button>
            <button id="cheat50" type="button" onclick="cheat(50)">cheat50</button>
            <button id="cheat120" type="button" onclick="cheat(120)">cheat120</button>
        </div>
        <div>
            <p id="test">sup</p>
        </div>
    </div>
</body>
<script>
var player = {
    tableCount: 0,
    timer: [0],
    timerVar: [0],
    money: 0
}
var gTimer = 0;
var gTimerVar = 0;
var chillthefuckout= 0;
var t = [
    { //table 0
        timeStart: 0,
        occupied: "no",
        course: {
            greet: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dispF: "order",
                orderTime: 5, //seconds
                needTime: 120 //seconds
            },
            drink: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 45, //minutes
                orderTime: 20, //seconds
                makeTime: 30, //seconds
                dueTime: 120, //seconds
                needTime: 120 //seconds
            },
            app: {
                makeWatcher: 0,
                sendWatcher: 0,
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                emptyDone: 0,
                bus: 0,
                dispF: "blank",
                estTime: 20, //minutes
                orderTime: 15, //seconds
                makeTime: 240, //seconds
                sendTime: 10, //seconds
                dueTime: 360, //seconds
                needTime: 180 //seconds
            },
            salad: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 16, //minutes
                makeTime: 30, //seconds
                dueTime: 240, //seconds
                needTime: 180 //seconds
            },
            entree: {
                makeWatcher: 0,
                sendWatcher: 0,
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 40, //minutes
                orderTime: 60, //seconds
                makeTime: 540, //seconds
                sendTime: 45, //seconds
                dueTime: 720, //seconds
                needTime: 180 //seconds
            },
            dessert: {
                makeWatcher: 0,
                sendWatcher: 0,
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 10, //minutes
                orderTime: 15, //seconds
                makeTime: 120, //seconds
                sendTime: 15, //seconds
                dueTime: 240, //seconds
                needTime: 120 //seconds
            },
            bill: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                makeTime: 10, //seconds
            },
            receipt: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                dueTime: 240, //seconds
                makeTime: 30 //seconds
            },
        },
        g: [
            {//empty because these are actually disp columns and 0 is the sider
            },
            { //guest 1
                thirst: 0,
                hunger: 0,
                drinkEmpty: 0,
                saladEmpty: 0,
                entreeEmpty: 0,
                dessertEmpty: 0,
                billEmpty: 0,
                receiptEmpty: 0,
                saladBus: 0,
                entreeBus: 0,
                dessertBus: 0,
                billBus: 0,
                receiptBus: 0,
                debt: 0
            }
        ]
    },
    { //table 0
        timeStart: 0,
        occupied: "no",
        course: {
            greet: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dispF: "order",
                orderTime: 5, //seconds
                needTime: 120 //seconds
            },
            drink: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 45, //minutes
                orderTime: 20, //seconds
                makeTime: 30, //seconds
                dueTime: 120, //seconds
                needTime: 120 //seconds
            },
            app: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                emptyDone: 0,
                bus: 0,
                dispF: "blank",
                estTime: 20, //minutes
                orderTime: 15, //seconds
                makeTime: 240, //seconds
                sendTime: 10, //seconds
                dueTime: 360, //seconds
                needTime: 180 //seconds
            },
            salad: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 16, //minutes
                makeTime: 30, //seconds
                dueTime: 240, //seconds
                needTime: 180 //seconds
            },
            entree: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 40, //minutes
                orderTime: 60, //seconds
                makeTime: 540, //seconds
                sendTime: 45, //seconds
                dueTime: 720, //seconds
                needTime: 180 //seconds
            },
            dessert: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 10, //minutes
                orderTime: 15, //seconds
                makeTime: 120, //seconds
                sendTime: 15, //seconds
                dueTime: 240, //seconds
                needTime: 120 //seconds
            },
            bill: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                makeTime: 10, //seconds
            },
            receipt: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                dueTime: 240, //seconds
                makeTime: 30 //seconds
            },
        },
        g: [
            {//empty because these are actually disp columns and 0 is the sider
            },
            { //guest 1
                thirst: 0,
                hunger: 0,
                drinkEmpty: 0,
                saladEmpty: 0,
                entreeEmpty: 0,
                dessertEmpty: 0,
                billEmpty: 0,
                receiptEmpty: 0,
                saladBus: 0,
                entreeBus: 0,
                dessertBus: 0,
                billBus: 0,
                receiptBus: 0,
                debt: 0
            }
        ]
    },
    { //table 0
        timeStart: 0,
        occupied: "no",
        course: {
            greet: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dispF: "order",
                orderTime: 5, //seconds
                needTime: 120 //seconds
            },
            drink: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 45, //minutes
                orderTime: 20, //seconds
                makeTime: 30, //seconds
                dueTime: 120, //seconds
                needTime: 120 //seconds
            },
            app: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                emptyDone: 0,
                bus: 0,
                dispF: "blank",
                estTime: 20, //minutes
                orderTime: 15, //seconds
                makeTime: 240, //seconds
                sendTime: 10, //seconds
                dueTime: 360, //seconds
                needTime: 180 //seconds
            },
            salad: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 16, //minutes
                makeTime: 30, //seconds
                dueTime: 240, //seconds
                needTime: 180 //seconds
            },
            entree: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 40, //minutes
                orderTime: 60, //seconds
                makeTime: 540, //seconds
                sendTime: 45, //seconds
                dueTime: 720, //seconds
                needTime: 180 //seconds
            },
            dessert: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 10, //minutes
                orderTime: 15, //seconds
                makeTime: 120, //seconds
                sendTime: 15, //seconds
                dueTime: 240, //seconds
                needTime: 120 //seconds
            },
            bill: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                makeTime: 10, //seconds
            },
            receipt: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                dueTime: 240, //seconds
                makeTime: 30 //seconds
            },
        },
        g: [
            {//empty because these are actually disp columns and 0 is the sider
            },
            { //guest 1
                thirst: 0,
                hunger: 0,
                drinkEmpty: 0,
                saladEmpty: 0,
                entreeEmpty: 0,
                dessertEmpty: 0,
                billEmpty: 0,
                receiptEmpty: 0,
                saladBus: 0,
                entreeBus: 0,
                dessertBus: 0,
                billBus: 0,
                receiptBus: 0,
                debt: 0
            }
        ]
    },
    { //table 0
        timeStart: 0,
        occupied: "no",
        course: {
            greet: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dispF: "order",
                orderTime: 5, //seconds
                needTime: 120 //seconds
            },
            drink: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 45, //minutes
                orderTime: 20, //seconds
                makeTime: 30, //seconds
                dueTime: 120, //seconds
                needTime: 120 //seconds
            },
            app: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                emptyDone: 0,
                bus: 0,
                dispF: "blank",
                estTime: 20, //minutes
                orderTime: 15, //seconds
                makeTime: 240, //seconds
                sendTime: 10, //seconds
                dueTime: 360, //seconds
                needTime: 180 //seconds
            },
            salad: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 16, //minutes
                makeTime: 30, //seconds
                dueTime: 240, //seconds
                needTime: 180 //seconds
            },
            entree: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                makeReady: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 40, //minutes
                orderTime: 60, //seconds
                makeTime: 540, //seconds
                sendTime: 45, //seconds
                dueTime: 720, //seconds
                needTime: 180 //seconds
            },
            dessert: {
                show: 0,
                needAct: 0,
                actDone: 0,
                orderTaken: 0,
                dropDue: 0,
                makeSent: 0,
                makeDone: 0,
                sendDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 10, //minutes
                orderTime: 15, //seconds
                makeTime: 120, //seconds
                sendTime: 15, //seconds
                dueTime: 240, //seconds
                needTime: 120 //seconds
            },
            bill: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                makeTime: 10, //seconds
            },
            receipt: {
                show: 0,
                orderTaken: 0,
                dropDue: 0,
                makeDone: 0,
                makeGot: 0,
                orderDropd: 0,
                dispF: "blank",
                estTime: 2, //minutes
                dueTime: 240, //seconds
                makeTime: 30 //seconds
            },
        },
        g: [
            {//empty because these are actually disp columns and 0 is the sider
            },
            { //guest 1
                thirst: 0,
                hunger: 0,
                drinkEmpty: 0,
                saladEmpty: 0,
                entreeEmpty: 0,
                dessertEmpty: 0,
                billEmpty: 0,
                receiptEmpty: 0,
                saladBus: 0,
                entreeBus: 0,
                dessertBus: 0,
                billBus: 0,
                receiptBus: 0,
                debt: 0
            }
        ]
    }
];
var stage = {
    greet: {
        blank: function() {
            return "";
        },
        order: function(tbl) {
            if (timeLeft("greet","needAct",tbl) <= 0){
                return "late";
            } else {
                return ("Greet " + formatTime(timeLeft("greet","needAct",tbl)));
            }
        },
        ordering: function(tbl) {
            if (timeLeft("greet","actDone",tbl) <= 0){
                return "Greeted";
            } else {
                return ("Greeting " + formatTime(timeLeft("greet","actDone",tbl)));
            }
        }
    },
    drink: {
        blank: function() {
            return "";
        },
        order: function(tbl) {
            if (timeLeft("drink","needAct",tbl) <= 0){
                return "late";
            } else {
                return ("Order Drink " + formatTime(timeLeft("drink","needAct",tbl)));
            }
        },
        ordering: function(tbl) {
            if (timeLeft("drink","actDone",tbl) <= 0){
                return ("Waiting " + formatTime(timeLeft("drink","dropDue",tbl)));
            } else {
                return ("Ordering " + formatTime(timeLeft("drink","actDone",tbl)));
            }
        },
        taken:"f",
        sent:"d",
        making:"f",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            return ("Drinking " + centLeft(g,"drinkEmpty",k,tbl));
        },
        dirty:"k",
        bus:"l"
    },
    app: {
        blank: function() {
            return "";
        },
        order: function(tbl) {
            if (timeLeft("app","needAct",tbl) <= 0){
                return "late";
            } else {
                return ("Order " + formatTime(timeLeft("app","needAct",tbl)));
            }
        },
        ordering: function(tbl) {
            if (timeLeft("app","actDone",tbl) <= 0){
                return ("Waiting " + formatTime(timeLeft("app","dropDue",tbl)));
            } else {
                return ("Ordering " + formatTime(timeLeft("app","actDone",tbl)));
            }
        },
        taken:"s",
        sending:"f",
        sent:"d",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            return ("Eating " + centLeft("app","emptyDone",k,tbl));
        },
        dirty:"k",
        bus: function() {
            return "";
        }
    },
    salad: {
        blank: function() {
            return "";
        },
        order: function(tbl) {
            if (timeLeft("entree","needAct",tbl) <= 0){
                return "late";
            } else {
                return ("Order " + formatTime(timeLeft("entree","needAct",tbl)));
            }
        },
        ordering: function(tbl) {
            if (timeLeft("entree","actDone",tbl) <= 0){
                return ("Waiting " + formatTime(timeLeft("salad","dropDue",tbl)));
            } else {
                return ("Ordering " + formatTime(timeLeft("entree","actDone",tbl)));
            }
        },
        taken:"s",
        sent:"d",
        making:"f",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            if (t[tbl].g[g].saladBus == 1){
                return "";
            } else {
            return ("Eating " + centLeft(g,"saladEmpty",k,tbl));
            }
        },
        dirty:"k",
        bus:"j"
    },
    entree: {
        blank: function() {
            return "";
        },
        order: function(tbl) {
            if (timeLeft("entree","needAct",tbl) <= 0){
                return "late";
            } else {
                return ("Order " + formatTime(timeLeft("entree","needAct",tbl)));
            }
        },
        ordering: function(tbl) {
            if (timeLeft("entree","actDone",tbl) <= 0){
                return ("Waiting " + formatTime(timeLeft("entree","dropDue",tbl)));
            } else {
                return ("Ordering " + formatTime(timeLeft("entree","actDone",tbl)));
            }
        },
        taken:"s",
        sending:"f",
        sent:"d",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            if (t[tbl].g[g].entreeBus == 1){
                return "";
            } else {
            return ("Eating " + centLeft(g,"entreeEmpty",k,tbl));
            }
        },
        dirty:"k",
        bus: function() {
            return "";
        }
    },
    dessert: {
        blank: function() {
            return "";
        },
        order: function(tbl) {
            return ("Order " + formatTime(timeLeft("dessert","needAct",tbl)));
        },
        ordering: function(tbl) {
            if (timeLeft("dessert","actDone",tbl) <= 0){
                return ("Waiting " + formatTime(timeLeft("dessert","dropDue",tbl)));
            } else {
                return ("Ordering " + formatTime(timeLeft("dessert","actDone",tbl)));
            }
        },
        taken:"s",
        sending:"f",
        sent:"d",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            if (t[tbl].g[g].dessertBus == 1){
                return "";
            } else {
            return ("Eating " + centLeft(g,"dessertEmpty",k,tbl));
            }
        },
        dirty:"k",
        bus: function() {
            return "";
        }
    },
    bill: {
        blank: function() {
            return "";
        },
        taken:"s",
        sent:"d",
        making:"f",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            if (t[tbl].g[g].billBus == 1){
                return "Paid";
            } else if (t[tbl].g[g].billEmpty < getTableTime(tbl)){
                return "Paying 100%";
            } else {
            return ("Paying " + centLeft(g,"billEmpty",k,tbl));
            }
        },
        dirty:"k",
        bus:"l"
    },
    receipt:{
        blank: function() {
            return "";
        },
        ordering: function(tbl) {
            if (timeLeft("receipt","dropDue",tbl) > 0){
                return ("Waiting " + formatTime(timeLeft("receipt","dropDue",tbl)));
            } else {
                return "late1";
            }
        },
        taken:"s",
        sent:"d",
        making:"f",
        done:"g",
        got:"h",
        dropd: function(tbl,g,k) {
            return "game over";
        }
    },
};
var dispHedVar = [{
        "b0": "Table: ",
        "b1": "0",
        "b2": "Time",
        "b3": "0:00"
    }, {
        "b0": "Guests: ",
        "b1": "num",
        "b2": "Bill",
        "b3": "$0"
    }];
var dispTableVar = [
    {
    "g0": ""}, {
    "g0": "Greet"}, {
    "g0": "Drink"}, {
    "g0": "Appetizer"}, {
    "g0": "Salad"}, {
    "g0": "Entree"}, {
    "g0": "Dessert"}, {
    "g0": "Bill"}, {
    "g0": "Receipt"
}];
window.onload = function(){
    gTimer = 0;
    gTimerVar = setInterval(function(){
        gTimer++;
    }, 1000);
    //document.getElementById("dev").style.display = "none"; //comment for dev mode
};

function newTable(tbl){
    player.timer[tbl] = 0;
    player.timerVar[tbl] = setInterval(function(){
        player.timer[tbl]++;
            update(tbl);
    }, 1000);
    player.tableCount+=1;
    guestCount = getRnd(1,9);
    addGuestInit(guestCount,tbl);
    addGuestDisp(guestCount,tbl);
    displayTable(tbl);
    var w = tbl
    document.getElementById("table"+w).innerHTML+= ("<div id=\""+w+"buttons\"><p><div id=\""+w+"b1\"><button id=\"ordergreet"+w+"\" type=\"button\" onclick=\"order('greet',"+w+")\">Greet</button></div></p><p><div id=\""+w+"b2\"><button id=\"orderdrink"+w+"\" type=\"button\" onclick=\"order('drink',"+w+")\">Order Drink</button><button id=\"makedrink"+w+"\" type=\"button\" onclick=\"make('drink',"+w+")\">Make Drink</button><button id=\"dropdrink"+w+"\" type=\"button\" onclick=\"drop('drink',"+w+")\">Drop Drink</button><button id=\"busdrink"+w+"\" type=\"button\" onclick=\"bus('drink',"+w+")\">Bus Drink</button></div></p><p><div id=\""+w+"b3\"><button id=\"orderapp"+w+"\" type=\"button\" onclick=\"order('app',"+w+")\">Order App</button><button id=\"sendapp"+w+"\" type=\"button\" onclick=\"send('app',"+w+")\">Send App</button><button id=\"getapp"+w+"\" type=\"button\" onclick=\"get('app',"+w+")\">Get App</button><button id=\"dropapp"+w+"\" type=\"button\" onclick=\"drop('app',"+w+")\">Drop App</button><button id=\"busapp"+w+"\" type=\"button\" onclick=\"bus('app',"+w+")\">Bus App</button></div></p><p><div id=\""+w+"b4\"><button id=\"makesalad"+w+"\" type=\"button\" onclick=\"make('salad',"+w+")\">Make Salad</button><button id=\"dropsalad"+w+"\" type=\"button\" onclick=\"drop('salad',"+w+")\">Drop Salad</button><button id=\"bussalad"+w+"\" type=\"button\" onclick=\"bus('salad',"+w+")\">Bus Salad</button></div></p><p><div id=\""+w+"b5\"><button id=\"orderentree"+w+"\" type=\"button\" onclick=\"order('entree',"+w+")\">Order Entree</button><button id=\"sendentree"+w+"\" type=\"button\" onclick=\"send('entree',"+w+")\">Send Entree</button><button id=\"getentree"+w+"\" type=\"button\" onclick=\"get('entree',"+w+")\">Get Entree</button><button id=\"dropentree"+w+"\" type=\"button\" onclick=\"drop('entree',"+w+")\">Drop Entree</button><button id=\"busentree"+w+"\" type=\"button\" onclick=\"bus('entree',"+w+")\">Bus Entree</button></div></p><p><div id=\""+w+"b6\"><button id=\"orderdessert"+w+"\" type=\"button\" onclick=\"order('dessert',"+w+")\">Order Dessert</button><button id=\"senddessert"+w+"\" type=\"button\" onclick=\"send('dessert',"+w+")\">Send Dessert</button><button id=\"getdessert"+w+"\" type=\"button\" onclick=\"get('dessert',"+w+")\">Get Dessert</button><button id=\"dropdessert"+w+"\" type=\"button\" onclick=\"drop('dessert',"+w+")\">Drop Dessert</button><button id=\"busdessert"+w+"\" type=\"button\" onclick=\"bus('dessert',"+w+")\">Bus Dessert</button></div></p><p><div id=\""+w+"b7\"><button id=\"makebill"+w+"\" type=\"button\" onclick=\"make('bill',"+w+")\">Print Bill</button><button id=\"dropbill"+w+"\" type=\"button\" onclick=\"drop('bill',"+w+")\">Drop Bill</button><button id=\"busbill"+w+"\" type=\"button\" onclick=\"bus('bill',"+w+")\">Pick Up Bill</button></div></p><p><div id=\""+w+"b8\"><button id=\"makereceipt"+w+"\" type=\"button\" onclick=\"make('receipt',"+w+")\">Run Bill</button><button id=\"dropreceipt"+w+"\" type=\"button\" onclick=\"drop('receipt',"+w+")\">Drop Receipt</button><button id=\"busreceipt"+w+"\" type=\"button\" onclick=\"bus('receipt',"+w+")\">Pick Up Receipt</button></div></p></div>");
    displayButtons("none",tbl);
    update(tbl);
    t[tbl].timeStart = gTimer;
    for (var i = 1; i < (t[tbl].g.length); i++){
        temp = Object.getOwnPropertyNames(t[tbl].g[1]);
        for (var j = 0; j < Object.keys(t[tbl].g[1]).length; j++) {
            nowTemp = temp[j];
            setGVar(i,nowTemp,tbl);
        }
    }
    //document.getElementById("newTable").style.display = "none";
    chillthefuckout = 1;
    t[tbl].course.greet.show = 1;
    document.getElementById(["ordergreet"+tbl]).style.display = "inline";
    setEndTime("greet","needAct",t[tbl].course.greet.needTime,tbl);
}
function displayTable(tbl){
    var tbody = document.getElementById("dispBody"+tbl);
    tbody.innerHTML = ""; //wipes old table
    for (var i = 0; i < Object.keys(dispHedVar).length; i++) {
        temp = "<tr id = \"" + "t" + tbl + "h" + i + "\">";
        for (let key in dispHedVar[i]) {
            temp += "<td id = \"" + "t" + tbl + "h" + i + key + "\">" + dispHedVar[i][key] + "</td>";
        } 
        tbody.innerHTML += temp;
    }   
    for (var j = 0; j < Object.keys(dispTableVar).length; j++) {
        temp = "<tr id = \"" + "t" + tbl + "c" + j + "\">";
        for (let key in dispTableVar[j]) {
            temp += "<td id = \"" + "t" + tbl + key + "c" + j + "\">" + dispTableVar[j][key] + "</td>";
        } 
        tbody.innerHTML += temp;
    }
    tbody.innerHTML += "<tr><td id=\"t"+tbl+"status\" colspan=\"4\">sup</tr></td>";
}
function addGuestDisp(k,tbl){
    for (var j = 0; j < k; j++){
        //guestNum = (j+1);
        document.getElementById("test").innerHTML += (j+1);
        dispTableVar[0]["g"+(j+1)] = "Guest " + (j+1);
        for (var i = 1; i < Object.keys(dispTableVar).length; i++) {
            dispTableVar[i]["g"+(j+1)] = "";
        }
    }
    //displayTable(tbl);
}
function displayButtons(k,tbl){
    var el = document.getElementById([tbl+'buttons']);
    var all = el.getElementsByTagName('button');
    var i;
    for (var i = 0; i < all.length; i++) {
       all[i].style.display = k;
    }
}
function disabledButtons(k,tbl){
    //enable buttons
    var el = document.getElementById("gameBoard");
    var all = el.getElementsByTagName('button');
    var i;
    for (var i = 0; i < all.length; i++) {
        all[i].disabled = k;
    }
}
function getRnd(min, max) {
    //returns int; min (included) and max (excluded)
    return Math.floor(Math.random() * (max - min) ) + min;
}
function addGuestInit(k,tbl){
    for (var j = 1; j < k; j++){
        t[tbl].g[j+1] = {};
        temp = Object.getOwnPropertyNames(t[tbl].g[1]);
        for (var i = 0; i < Object.keys(t[tbl].g[1]).length; i++) {
            nowTemp = temp[i];
            t[tbl].g[j+1][[nowTemp]] = 0;
        }
    }
}
function update(tbl){
    document.getElementById("t"+tbl+"h0b1").innerHTML= tbl;
    document.getElementById("t"+tbl+"h0b3").innerHTML= formatTime(getTableTime(tbl));
    document.getElementById("t"+tbl+"h1b1").innerHTML= t[tbl].g.length - 1;
    document.getElementById("t"+tbl+"h1b3").innerHTML= "$ " + addBill(tbl);
    var x, y;
    var temp = Object.getOwnPropertyNames(t[tbl].course);
    for(i = 0; i < Object.keys(t[tbl].course).length; i++){
        nowTemp = temp[i];
        switch(t[tbl].course[[nowTemp]].show){
            case 1:
                x = "visible";
                y = "inline";
                break;
            case 0:
                x = "hidden";
                y = "none";
                break;
            }
        document.getElementById(["t"+tbl+"c"+(i+1)]).style.visibility = x;
        document.getElementById([tbl+"b"+(i+1)]).style.display = y;
    }
    for (var j = 1; j < t[tbl].g.length; j++) {
        for (var p = 0; p < 8; p++){
            var cell = ("t"+tbl+"g"+j+"c"+(p+1));
            var c = temp[p];
            var f = t[tbl].course[c].dispF;
            var z = stage[c][f](tbl,j,c);
            document.getElementById(cell).innerHTML= z;
        }
    }
    if (t[tbl].occupied > getTableTime(tbl)){
        disabledButtons(true,tbl);
        document.getElementById("t"+tbl+"status").innerHTML= "busy " + formatTime(t[tbl].occupied - getTableTime(tbl));
    } else {
        disabledButtons(false,tbl);
        document.getElementById("t"+tbl+"status").innerHTML= "do something";
        if ((t[tbl].course.app.orderSent == 1) && (t[tbl].course.app.makeReady != 1)){
            document.getElementById("getapp"+tbl).disabled = true;
            document.getElementById("t"+tbl+"status").innerHTML= "cooking " + formatTime(t[tbl].course.app.makeDone - getTableTime(tbl));
        }
        if ((t[tbl].course.entree.orderSent == 1) && (t[tbl].course.entree.makeReady != 1)){
            document.getElementById("getentree"+tbl).disabled = true;
            document.getElementById("t"+tbl+"status").innerHTML= "cooking " + formatTime(t[tbl].course.entree.makeDone - getTableTime(tbl));
        }
        if ((t[tbl].course.dessert.orderSent == 1) && (t[tbl].course.dessert.makeReady != 1)){
            document.getElementById("getdessert"+tbl).disabled = true;
            document.getElementById("t"+tbl+"status").innerHTML= "cooking " + formatTime(t[tbl].course.dessert.makeDone - getTableTime(tbl));
        }
    }
}
function getTableTime(tbl = 0){
    return (gTimer - t[tbl].timeStart);
}
function formatTime(s) {
    //source: https://stackoverflow.com/a/37770048
    return(0>s?(s=-s,'-'):0)+(s-(s%=60))/60+(9<s?':':':0')+s;
}
function setGVar(guest,prop,tbl){
    switch (prop){
        case "thirst":
        case "hunger":
            t[tbl].g[guest][prop] = getRnd(2, 5);
            break;
        default:
            t[tbl].g[guest][prop] = 0;
            break;
    }
}
function addBill(tbl){
    var sum = 0;
    for(var i = 1; i < (t[tbl].g.length); i++){
        sum += t[tbl].g[i].debt;
    }
  return sum;
}
function order(k,tbl){
    t[tbl].occupied = setEndTime(k,"actDone",t[tbl].course[k].orderTime,tbl);
    t[tbl].course[k].dispF = "ordering";
    var d = "order"+k+tbl;
    document.getElementById(d).style.display = "none";
    setEndTime(k,"dropDue",t[tbl].course[k].dueTime,tbl);
    switch(k){
        case 'greet':
            setEndTime("drink","needAct",t[tbl].course.drink.needTime,tbl);
            t[tbl].course.drink.show = 1;
            t[tbl].course.drink.dispF = "order";
            document.getElementById("orderdrink"+tbl).style.display = "inline";
            break;
        case 'drink':
            setEndTime("app","needAct",t[tbl].course.app.needTime,tbl);
            t[tbl].course.app.show = 1;
            t[tbl].course.app.dispF = "order";
            t[tbl].course.greet.dispF = "blank";
            document.getElementById("makedrink"+tbl).style.display = "inline";
            document.getElementById("orderapp"+tbl).style.display = "inline";
            for (var j = 1; j < t[tbl].g.length; j++) {
                t[tbl].g[j].debt+= getRnd(0,4);
            }
            break;
        case 'app':
            document.getElementById("sendapp"+tbl).style.display = "inline";
            for (var j = 1; j < t[tbl].g.length; j++) {
                t[tbl].g[j].debt+= getRnd(3,7);
            }
            break;
        case 'entree':
            setEndTime("salad","dropDue",t[tbl].course.salad.dueTime,tbl);
            t[tbl].course.salad.dispF = "ordering";
            document.getElementById("sendentree"+tbl).style.display = "inline";
            document.getElementById("makesalad"+tbl).style.display = "inline";
            for (var j = 1; j < t[tbl].g.length; j++) {
                t[tbl].g[j].debt+= getRnd(10,36);
            }
            break;
        case 'dessert':
            document.getElementById("senddessert"+tbl).style.display = "inline";
            for (var j = 1; j < t[tbl].g.length; j++) {
                t[tbl].g[j].debt+= getRnd(3,11);
            }
            break;
    }
    update(tbl);
}
function make(k,tbl){
    t[tbl].occupied = setEndTime(k,"makeDone",t[tbl].course[k].makeTime,tbl);
    t[tbl].course[k].makeWatcher = setInterval(function() { //needs multi call support
        t[tbl].course[k].makeGot = endWatcher(t[tbl].course[k].makeDone,[t[tbl].course[k].makeWatcher],tbl);
    }, 1000);
    var d = "drop"+k+tbl;
    var h = "make"+k+tbl;
    document.getElementById(d).style.display = "inline";
    document.getElementById(h).style.display = "none";
    update(tbl);
}
function send(k,tbl){
    t[tbl].occupied = setEndTime(k,"makeDone",t[tbl].course[k].makeTime,tbl);
    t[tbl].occupied = setEndTime(k,"sendDone",t[tbl].course[k].sendTime,tbl);
    var d = "send"+k+tbl;
    var h = "get"+k+tbl;
    document.getElementById(d).style.display = "none";
    document.getElementById(h).style.display = "inline";
    t[tbl].course[k].orderSent = 1;
    t[tbl].course[k].sendWatcher = setInterval(function() {
        t[tbl].course[k].makeReady = endWatcher(t[tbl].course[k].makeDone,[t[tbl].course[k].sendWatcher],tbl);
    }, 1000);
    update(tbl);
}
function get(k,tbl){
    var d = "drop"+k+tbl;
    var h = "get"+k+tbl;
    if (t[tbl].course[k].makeDone <= getTableTime(tbl)){
        t[tbl].course[k].makeGot = 1;
        document.getElementById(d).style.display = "inline";
        document.getElementById(h).style.display = "none";
    }
    update(tbl);
}
function drop(k,tbl){
    if(t[tbl].course[k].makeGot == 1){
        t[tbl].course[k].makeGot = 0;
        t[tbl].course[k].orderDropd = 1;
        t[tbl].course[k].dispF = "dropd";
        var d = "bus"+k+tbl;
        var h = "drop"+k+tbl;
        var r = k+"Empty";
        document.getElementById(d).style.display = "inline";
        document.getElementById("busdrink"+tbl).style.display = "none"; //clears unused drink bus
        document.getElementById("busreceipt"+tbl).style.display = "none"; //clears unused drink bus
        document.getElementById(h).style.display = "none";
        for (var j = 1; j < t[tbl].g.length; j++) {
            setEmptyTime(j,r,k,tbl);
        }
        switch(k){
            case 'app':
                setEmptyTime("app","emptyDone",k,tbl);
                document.getElementById("orderentree"+tbl).style.display = "inline";
                t[tbl].course.salad.show = 1;
                t[tbl].course.entree.show = 1;
                setEndTime("entree","needAct",t[tbl].course.entree.needTime,tbl);
                t[tbl].course.entree.dispF = "order";
                t[tbl].course.salad.dispF = "order";
                break;
            case 'drink':
                document.getElementById("makedrink"+tbl).style.display = "inline";
                break;
            case 'entree':
                document.getElementById("orderdessert"+tbl).style.display = "inline";
                break;
            case 'dessert':
                document.getElementById("makebill"+tbl).style.display = "inline";
                t[tbl].course.bill.show = 1;
                break;
            case 'receipt':
                t[tbl].course.greet.show = 0;
                t[tbl].course.drink.show = 0;
                t[tbl].course.app.show = 0;
                t[tbl].course.salad.show = 0;
                t[tbl].course.entree.show = 0;
                t[tbl].course.dessert.show = 0;
                t[tbl].course.bill.show = 0;
                break;
        }
        update(tbl);
    }
}
function bus(k,tbl){
    var d = k+"Bus";
    var h = "bus"+k+tbl;
    var r = k+"Empty";
    for (var j = 1; j < t[tbl].g.length; j++) {
        if(t[tbl].g[j][r] <= getTableTime(tbl)){
            t[tbl].g[j][d] = 1;
        }
    }
    var temp = 0;
    for (var m = 1; m < t[tbl].g.length; m++) {                
        if (t[tbl].g[m][d] == 1){
            temp+=1;
        }
        if (temp == (t[tbl].g.length - 1)){
            document.getElementById(h).style.display = "none";
            if (k == 'entree'){
                t[tbl].course.dessert.show = 1;
                t[tbl].course.dessert.dispF = "order";
                setEndTime("dessert","needAct",t[tbl].course.dessert.needTime,tbl);
            }
        }
    }
    switch(k){
        case 'app':
            if(t[tbl].course.app.emptyDone <= getTableTime(tbl)){
                t[tbl].course.app.bus = 1;
                document.getElementById("busapp"+tbl).style.display = "none";
                t[tbl].course.app.dispF = "bus";
            }
            break;
        case 'bill':
            if (temp == (t[tbl].g.length - 1)){
                document.getElementById("busbill"+tbl).style.display = "none";
                t[0].course.receipt.show = 1;
                document.getElementById("makereceipt"+tbl).style.display = "inline";
                t[tbl].course.receipt.dispF = "ordering";
                setEndTime("receipt","dropDue",t[tbl].course.receipt.dueTime,tbl);
            }
            break;
    }
    update(tbl);
}
function setEndTime(c,x,y,tbl){
    return t[tbl].course[c][x] = (getTableTime(tbl) + y);
}
function timeLeft(c,x,tbl){
    return (t[tbl].course[c][x] - getTableTime(tbl));
}
function endWatcher(time,flag,tbl){
    if (time <= (getTableTime(tbl))+1){
        clearInterval(flag);
        return 1; 
    }
}
function centLeft(c,x,z,tbl){
    var y = (t[tbl].course[z].estTime * 0.6);
    var temp = 0;
    if (c == "app"){
        y = (t[tbl].course.app.estTime * 0.6);
        for (var j = 1; j < t[tbl].g.length; j++) {
            temp += t[tbl].g[j].hunger;
        }
        temp = temp / t[tbl].g.length;
        return ((Math.round((t[tbl].course[c][x] - getTableTime(tbl)) / (y * (1 / temp)))) + "%");
    } else if (z == "drink") {
        temp = t[tbl].g[c].thirst;
        return ((Math.round((t[tbl].g[[c]][x] - getTableTime(tbl)) / (y * (1 / temp))))+ "%");
    } else if (z == "bill") {
        temp = (t[tbl].g[c].thirst + t[tbl].g[c].hunger);
        return ((100-(Math.round((t[tbl].g[[c]][x] - getTableTime(tbl)) / (y * (1 / temp)))))+ "%");
    } else {
        temp = t[tbl].g[c].hunger;
        return ((Math.round((t[tbl].g[[c]][x] - getTableTime(tbl)) / (y * (1 / temp))))+ "%");
    }
}
function setEmptyTime(c,x,z,tbl){
    var y = (t[tbl].course[z].estTime * 60);
    var temp = 0;
    if (c == "app"){
        y = (t[tbl].course.app.estTime * 60);
        for (var j = 1; j < t[tbl].g.length; j++) {
            temp += t[tbl].g[j].hunger;
        }
        temp = temp / t[tbl].g.length;
        t[tbl].course[c][x] = getTableTime(tbl) + (y * (1 / temp));
    } else if (z == "drink"){
        temp = t[tbl].g[c].thirst;
        t[tbl].g[c][x] = getTableTime(tbl) + (y * (1 / temp));
    } else if (z == "bill") {
        temp = (t[tbl].g[c].thirst + t[tbl].g[c].hunger);
        t[tbl].g[c][x] = getTableTime(tbl) + (y * (1 / temp));
    } else {
        temp = t[tbl].g[c].hunger;
        t[tbl].g[c][x] = getTableTime(tbl) + (y * (1 / temp));
    }
}
function cheat(k){
    gTimer = gTimer + k;
}
</script>