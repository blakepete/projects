<!DOCTYPE html>
<html>
<title>ServeMeFirst Alpha 1.3.1</title>
<head>
<!Blake Peterson 2018
blake.r.peterson@gmail.com>
</head>
<body>

<p id="t0title">get</p>
<p id="t0time">a</p>
<p id="t0need">table</p>
<p id="t0g0status">ya</p>
<p id="t0g1status">noob</p>
<button id="addTable" type="button" onclick="newTable()">Add Table</button>
<button id="greet" type="button" onclick="greetTable()">greet</button>
<button id="orderDrinks" type="button" onclick="orderDrinks()">orderDrinks</button>
<button id="makeDrinks" type="button" onclick="makeDrinks()">makeDrinks</button>
<button id="giveDrinks" type="button" onclick="giveDrinks()">giveDrinks</button>
<button id="orderApps" type="button" onclick="orderApps()">orderApps</button>
<button id="sendApps" type="button" onclick="sendApps()">sendApps</button>
<button id="giveApps" type="button" onclick="giveApps()">giveApps</button>
<button id="orderEntrees" type="button" onclick="orderEntrees()">orderEntrees</button>
<!--
<button id="checkup" type="button" onclick="checkup()">checkup</button>
<button id="giveFood" type="button" onclick="giveFood()">giveFood</button>
<button id="orderDesert" type="button" onclick="orderDesert()">orderDesert</button>
<button id="giveDesert" type="button" onclick="giveDesert()">giveDesert</button>
<button id="dropCheck" type="button" onclick="dropCheck()">dropCheck</button>
<button id="getCheck" type="button" onclick="getCheck()">getCheck</button>
<button id="runCheck" type="button" onclick="runCheck()">runCheck</button>
<button id="finalVisit" type="button" onclick="finalVisit()">finalVisit</button>
-->
<p id="playerDisplay">yo ho ho, serving life for me</p>
<p></p><button id="debug" type="button" onclick="debug()">debug</button>
<p id="debugOut">debug</p>
<script>
window.onload = function(){
    document.getElementById("greet").style.display="none";
    document.getElementById("orderDrinks").style.display="none";
    document.getElementById("makeDrinks").style.display="none";
    document.getElementById("giveDrinks").style.display="none"; 
    document.getElementById("orderApps").style.display="none"; 
    document.getElementById("sendApps").style.display="none";
    document.getElementById("giveApps").style.display="none";
    document.getElementById("orderEntrees").style.display="none";
};


var player = {
    display: "servant mode engage"
};

var t0 = {
    timer: [0, 0, 0, 0, 0, 0, 0],
        //0visit,1drinks,2apps,3salads,4entrees,5dessert,6bill
    timerVar: [0, 0, 0, 0, 0, 0, 0],
    activeTimer: 0,
    status: 0,
    statuses: [
        "0Reading menu",
        "1Waiting for greeting",
        "2Greeting",
        "3Waiting to order drinks",
        "4Ordering drinks",
        "5Reading menu",
        "6Waiting for drinks",
        "7Waiting to order apps",
        "8Ordering apps",
        "9Reading menu",
        "10Waiting for apps",
        "11Eating apps",
        "12Waiting to order entrees",
        "13Ordering entrees",
        "14Finishing apps",
        "15Waiting for salads",
        "16Eating salads",
        "17Finishing salads",
        "18Waiting for entree",
        "19Eating entree",
        "20Halfway entree",
        "21Finishing entree",
        "22Waiting to order dessert",
        "23Ordering dessert",
        "24Waiting for dessert",
        "25Eating dessert",
        "26Finishing dessert",
        "27Waiting for bill",
        "28Looking at bill and not paying it",
        "29Bill ready to collect",
        "30Waiting for receipt",
        "31Leaving tip",
    ],
    guest: [
        {
            drink: 0,
            happy: 0,
            thirst: 0,
            needy: 0,
            tipper: 0
        }, {
            drink: 0,
            happy: 0,
            thirst: 0,
            needy: 0,
            tipper: 0
        }
    ],
    payor: 0
};

function getRnd(min, max) {
    //returns int; min (included) and max (excluded)
    return Math.floor(Math.random() * (max - min) ) + min;
}

function updater(){
    document.getElementById("t0time").innerHTML= "Table Time: " + t0.timer[0];
    document.getElementById("t0g0status").innerHTML= "Guest 1: Drink = " + t0.guest[0].drink + "% | Happiness = " + t0.guest[0].happy;
    document.getElementById("t0g1status").innerHTML= "Guest 1: Drink = " + t0.guest[1].drink + "% | Happiness = " + t0.guest[1].happy;
    document.getElementById("t0need").innerHTML= "Need: " + t0.statuses[t0.status] + ": " + t0.timer[t0.activeTimer];
    document.getElementById("playerDisplay").innerHTML= player.display;
}


function timerOn(k, l = -1){
    t0.timer[k] = t0.timer[k] + l;
    updater();
}



//function needTimerOn(){
//    t0.needTime--;
//    updater();
//    if (t0.needTime == -1){
//        t0.guest[0].happy = Math.round(t0.guest[0].happy - Math.random());
//        t0.guest[1].happy = Math.round(t0.guest[1].happy - Math.random());
//        updater();
//    } else if (t0.needTime == -30){
//        t0.guest[0].happy = t0.guest[0].happy - 1;
//        t0.guest[1].happy = t0.guest[1].happy - 1;
//        updater();
//    }
//}

function newTable(){
    t0.timerVar[0] = setInterval(timerOn.bind(null, 0 , 1), 1000);
    t0.status = 0;
    t0.timer[1] = 30;
    t0.timerVar[1] = setInterval(timerOn.bind(null, 1), 1000);
    t0.timer[2] = 180;
    t0.timerVar[2] = setInterval(timerOn.bind(null, 2), 1000);
    t0.activeTimer = 1;
    t0.guest[0].drink = 0;
    t0.guest[1].drink = 0;
    t0.guest[0].happy = getRnd(-1, 5);
    t0.guest[1].happy = getRnd(-1, 5);
    t0.guest[0].thirst = getRnd(1, 4);
    t0.guest[1].thirst = getRnd(1, 4);    
    t0.guest[0].needy = getRnd(1, 11);
    t0.guest[1].needy = getRnd(1, 11);
    t0.guest[0].tipper = getRnd(5, 26);
    t0.guest[1].tipper = getRnd(5, 26);
    t0.payor = getRnd(0, 2);
    player.display = "you've been sat";
    document.getElementById("t0title").innerHTML= "Table 0";
    document.getElementById("greet").style.display="inline";
    document.getElementById("addTable").disabled = true;
    updater(); 
}

function greetTable(){
    clearInterval(t0.timerVar[1]);
    if (t0.timer[0] < 5) {
        t0.guest[0].happy = Math.round(t0.guest[0].happy - Math.random());
        t0.guest[1].happy = Math.round(t0.guest[1].happy - Math.random());
        player.display = "they're still playing musical chairs. but hi.";
    } else {
        t0.guest[0].happy = Math.round(t0.guest[0].happy + Math.random());
        t0.guest[1].happy = Math.round(t0.guest[1].happy + Math.random());
        player.display = "yada yada yada";
    }
    document.getElementById("greet").style.display="none";
    document.getElementById("orderDrinks").style.display="inline";
    document.getElementById("orderDrinks").disabled = true;
    t0.status = 2;
    t0.timer[1] = 5;
    t0.timerVar[1] = setInterval(timerOn.bind(null, 1), 1000);
    setTimeout(function(){ 
        clearInterval(t0.timerVar[1]);
        document.getElementById("orderDrinks").disabled = false;
        t0.status = 3;
        t0.timer[1] = 90;
        t0.timerVar[1] = setInterval(timerOn.bind(null, 1), 1000);
        player.display = "greeted. time for a drink order";
        updater();
    }, 5000);
    updater();
}

function orderDrinks(){
    clearInterval(t0.timerVar[1]);
    if (t0.timer[0] < 15) {
        t0.guest[0].happy = Math.round(t0.guest[0].happy - Math.random());
        t0.guest[1].happy = Math.round(t0.guest[1].happy - Math.random());
        player.display = "they literally just sat down, waters around";
    } else {
        t0.guest[0].happy = Math.round(t0.guest[0].happy + Math.random());
        t0.guest[1].happy = Math.round(t0.guest[1].happy + Math.random());
        player.display = "2 diets probably";
    }
    document.getElementById("orderDrinks").style.display="none";
    document.getElementById("makeDrinks").style.display="inline";
    document.getElementById("makeDrinks").disabled = true;
    document.getElementById("giveDrinks").style.display="inline";
    document.getElementById("giveDrinks").disabled = true;
    document.getElementById("orderApps").style.display="inline";
    document.getElementById("orderApps").disabled = true;
    t0.status = 4;
    t0.timer[1] = 30;
    t0.timerVar[1] = setInterval(timerOn.bind(null, 1), 1000);
    setTimeout(function(){
        clearInterval(t0.timerVar[1]);
        document.getElementById("makeDrinks").disabled = false;
        document.getElementById("orderApps").disabled = false;
        t0.status = 6;
        t0.timer[1] = 120;
        t0.timerVar[1] = setInterval(timerOn.bind(null, 1), 1000);
        player.display = "got drinks, go make em";
        updater();
    }, 30000);
    updater();
}

function makeDrinks(){
    document.getElementById("makeDrinks").style.display="none";
    document.getElementById("orderApps").disabled = true;
    player.display = "scooping ice";
    setTimeout(function(){
        player.display = "filling first cup";
    }, 10000);
    setTimeout(function(){
        player.display = "filling second cup";
    }, 20000);    
    setTimeout(function(){
        player.display = "drink em if u got em, wait. no. these are for the table.";
        document.getElementById("giveDrinks").disabled = false;
    }, 30000);
    updater();
}

function giveDrinks(){
    clearInterval(t0.timerVar[1]);
    document.getElementById("giveDrinks").style.display="none";
    document.getElementById("orderApps").disabled = false;
    t0.guest[0].happy = t0.guest[0].happy + 1;
    t0.guest[1].happy = t0.guest[1].happy + 1;
    player.display = "here's your drunks";
    t0.status = 7;
    t0.activeTimer = 2;
    updater();
}

function orderApps(){
    clearInterval(t0.timerVar[2]);
    if (t0.timer[2] < 45) {
        t0.guest[0].happy = Math.round(t0.guest[0].happy - Math.random());
        t0.guest[1].happy = Math.round(t0.guest[1].happy - Math.random());
        player.display = "if this weren't a game, they wouldnt get apps";
    } else {
        t0.guest[0].happy = Math.round(t0.guest[0].happy + Math.random());
        t0.guest[1].happy = Math.round(t0.guest[1].happy + Math.random());
        player.display = "something fried and something mushroom";
    }
    document.getElementById("orderApps").style.display="none";
    document.getElementById("sendApps").style.display="inline";
    document.getElementById("sendApps").disabled = true;
    document.getElementById("giveApps").style.display="inline";
    document.getElementById("giveApps").disabled = true;
    document.getElementById("orderEntrees").style.display="inline";
    document.getElementById("orderEntrees").disabled = true;
    t0.status = 8;
    t0.timer[2] = 30;
    t0.timerVar[2] = setInterval(timerOn.bind(null, 2), 1000);
    setTimeout(function(){
        clearInterval(t0.timerVar[2]);
        document.getElementById("sendApps").disabled = false;
        document.getElementById("orderEntrees").disabled = false;
        t0.status = 10;
        t0.timer[2] = 300;
        t0.timerVar[2] = setInterval(timerOn.bind(null, 2), 1000);
        player.display = "apps ordered, send em to the kitchen";
        updater();
    }, 30000);
    updater();
}

function debug(){
    document.getElementById("debugOut").innerHTML= t0.timer[2];
}

</script>
 
</body>
</html>